define(["require","exports","durandal/app","durandal/system","models/document","common/raven"],function(n,t,i,r,u,f){var e=i,o=r,c=u,s=f,h=function(){function n(){this.document=ko.observable(),this.documentText=ko.observable(),this.ravenDb=new s}return n.prototype.activate=function(n){var i=this,t;if(n.id)return t=this.ravenDb.documentWithMetadata(n.id),t.done(function(n){var t=n.__metadata;n.__metadata=undefined,i.documentText(JSON.stringify(n,null,4)),n.__metadata=t,i.document(n)}),t.fail(function(t){o.log("Failed to load document for editing.",t),e.showMessage("Couldn't edit '"+n.id+"'. Details logged in the browser console.",":-(",["Dismiss"])}),t},n}();t.editDocument=h})