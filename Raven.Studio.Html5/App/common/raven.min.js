define(["require","exports","models/database","models/collection"],function(n,t,i,r){var u=i,f=r;return function(){function n(){this.baseUrl="http://localhost:8080"}return n.prototype.databases=function(){var n=function(n){return n.map(function(n){return new u(n)})};return this.fetch("/databases",{pageSize:1024},null,n)},n.prototype.collections=function(){this.requireActiveDatabase();var t=function(n){return n.map(function(n){return new f(n)})};return this.fetch("/terms/Raven/DocumentsByEntityName",{field:"Tag",fromValue:"",pageSize:100},n.activeDatabase(),t)},n.prototype.requireActiveDatabase=function(){if(!n.activeDatabase())throw new Error("Must have an active database before calling this method.");},n.prototype.fetch=function(n,t,i,r){var f=$.ajax({cache:!1,url:this.baseUrl+(i?"/databases/"+i.name:"")+n,data:t}),u;return r?(u=$.Deferred(),f.done(function(n){var t=r(n);u.resolve(t)}),u):f},n.activeDatabase=ko.observable().subscribeTo("ActivateDatabase"),n}()})